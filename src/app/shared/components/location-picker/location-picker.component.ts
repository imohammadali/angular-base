import { Component, EventEmitter, Input, OnChanges, OnInit, Output, SimpleChanges } from '@angular/core';
import * as mapboxgl from 'mapbox-gl';
import { environment } from 'src/environments/environment';

@Component({
  selector: 'app-location-picker',
  templateUrl: './location-picker.component.html',
  styleUrls: ['./location-picker.component.less']
})
export class LocationPickerComponent implements OnChanges {
  map: mapboxgl.Map;
  style = 'mapbox://styles/hejazi/cl37u5qdc002j14lapqes9f0y';
  center: [number, number] = [53.332983, 32.305416];
  southWest: [number, number] = [43.32937142517778, 23.103093546132413];
  northEast: [number, number] = [63.710294517298735, 39.81433205654136];
  maxBounds: any;
  zoom = 4;
  showMap = false;
  setBounds = false;
  @Input() location: { lat: number, long: number };
  @Input() province: string;
  @Input() city: string;
  @Input() disabled: boolean = false;
  @Input({ required: true }) visibleDialog: boolean = false; // When the map is used in a modal Or dialog , this value must be equal to the "visible_dialog_form" value.
  @Output() locationSelected: EventEmitter<{ lat: number, long: number }> = new EventEmitter();

  marker: mapboxgl.Marker;
  constructor(

  ) {

  }

  ngOnInit(): void {

  }

  ngOnChanges(changes: SimpleChanges): void {
    if (changes.visibleDialog && changes.visibleDialog.currentValue != changes.visibleDialog.previousValue && this.visibleDialog) {
      if (changes.visibleDialog.currentValue) {
        setTimeout(() => {
          this.buildMap();
        }, 100);
      }
    }
  }

  buildMap() {
    this.map = new mapboxgl.Map({
      container: 'map',
      style: this.style,
      zoom: this.zoom,
      center: this.center,
      accessToken: environment.mapbox.mapToken,
      attributionControl: false,

    })
    this.map.addControl(new mapboxgl.NavigationControl(
      {
        showCompass: false,
      }
    ));
    var geoLocation = new mapboxgl.GeolocateControl({
      positionOptions: {
        enableHighAccuracy: true,
      },
      trackUserLocation: true,
      showUserLocation: true,
    });
    this.map.addControl(geoLocation);
    if (!this.disabled) {
      this.map.on('click', (ev) => {
        this.location = {
          lat: ev.lngLat.lat,
          long: ev.lngLat.lng,
        }
        this.showMarker();
      });
    }
    this.map.on('idle', () => {
      if (!this.setBounds) {
        this.map.resize();
        this.map.fitBounds([this.southWest, this.northEast], { maxDuration: 1 });
        this.maxBounds = this.map.getBounds();
        this.map.setMaxBounds(this.maxBounds);
        if (this.location?.lat && this.location?.long) {
          this.map.flyTo({
            center: [this.location?.long, this.location?.lat],
            animate: false,
            zoom: 15,
          });
        } else if (this.city && this.cities[this.city.toLowerCase()]) {
          // this.map.setCenter(this.cities[this.city]);
          // this.map.setZoom(12);
          this.map.flyTo({
            center: this.cities[this.city.toLowerCase()],
            animate: false,
            zoom: 11,
          });
        } else if (this.province && this.provinces[this.province.toLowerCase()]) {
          this.map.fitBounds(this.provinces[this.province.toLowerCase()], { maxDuration: 1 });
        }
        this.setBounds = true;
        this.showMarker();
      }

      this.showMap = true;

    });
    // this.map.on('load', function () {
    //   try {
    //     geoLocation.trigger();
    //   } catch (error) {
    //   }
    // });

    // window.navigator.geolocation.getCurrentPosition((position) => {
    //   const userCoordinates = [position.coords.longitude, position.coords.latitude];
    //   // this.ShowLocation(userCoordinates);
    // });
    // window.navigator.geolocation.watchPosition((position) => {


    // });
  }
  showMarker() {
    if (this.location) {
      if (this.marker) {
        this.marker.setLngLat([this.location.long, this.location.lat]);
      } else {
        this.marker = new mapboxgl.Marker({ color: "#ff0000" }).setLngLat([this.location.long, this.location.lat]).addTo(this.map);
      }
    }
  }
  SelectLocation() {
    if (this.disabled) {
      return;
    }
    this.locationSelected.emit(this.location);
    console.log(this.location);

    // this.closeModal();
  }
  ShowLocation(userCoordinates: any) {
    const size = 100;
    const pulsingDot = {
      width: size,
      height: size,
      data: new Uint8Array(size * size * 4),

      // When the layer is added to the map,
      // get the rendering context for the map canvas.
      onAdd: function () {
        const canvas = document.createElement('canvas');
        canvas.width = this.width;
        canvas.height = this.height;
        this.context = canvas.getContext('2d');
      },

      // Call once before every frame where the icon will be used.
      render: function () {
        const duration = 1000;
        const t = (performance.now() % duration) / duration;

        const radius = (size / 2) * 0.3;
        const outerRadius = (size / 2) * 0.7 * t + radius;
        const context = this.context;

        // Draw the outer circle.
        context.clearRect(0, 0, this.width, this.height);
        // context.beginPath();
        // context.arc(
        //   this.width / 2,
        //   this.height / 2,
        //   outerRadius,
        //   0,
        //   Math.PI * 2
        // );
        // context.fillStyle = `rgba(29, 161, 242, ${(1 - t) * 0.6})`;
        // context.fill();

        // Draw the inner circle.
        context.beginPath();
        context.arc(
          this.width / 2,
          this.height / 2,
          radius,
          0,
          Math.PI * 2
        );
        context.fillStyle = 'rgb(29, 161, 242)';
        context.strokeStyle = 'white';
        context.lineWidth = 2 + 4 * (1 - t);
        context.fill();
        context.stroke();

        // Update this image's data with data from the canvas.
        this.data = context.getImageData(
          0,
          0,
          this.width,
          this.height
        ).data;

        // Continuously repaint the map, resulting
        // in the smooth animation of the dot.
        // if (this.map && this.map.loaded()) {
        //   this.map.triggerRepaint();
        // }
        // Return `true` to let the map know that the image was updated.
        return true;
      }
    };
    if (this.map && this.map.loaded()) {
      this.map.addImage('pulsing-dot', pulsingDot, { pixelRatio: 2 });

      this.map.addSource('user-coordinates', {
        type: 'geojson',
        data: {
          type: "Feature",
          geometry: {
            type: "Point",
            coordinates: userCoordinates
          }
        } as any
      });
      this.map.addLayer({
        id: "user-coordinates",
        source: "user-coordinates",
        type: 'symbol',
        layout: {
          'icon-image': 'pulsing-dot'
        }
      });
    } else {
      setTimeout(() => {
        this.ShowLocation(userCoordinates);
      }, 100);
    }
  }

  provinces = {
    "alborz": [[50.301567785125584, 35.6186178008783], [51.36588502915396, 36.109483791258306]],
    "ardabil": [[48.26403148163667, 38.20595370803584], [48.31346995643206, 38.265415994906334]],
    "azarbaijan gharbi": [[45.498105938128774, 36.155786344984044], [44.80057408877382, 39.413925724188196]],
    "azarbaijan sharghi": [[45.90483072272429, 37.53206640016887], [47.19983717171462, 38.96088035058592]],
    "bushehr": [[50.823266212159155, 28.909507269523175], [50.856482254242685, 28.971161148465125]],
    "chaharmahale bakhtiari": [[50.43989085943868, 31.506418397738678], [51.29957100449194, 32.1016342140879]],
    "esfahan": [[51.636910855508866, 32.54910432854153], [51.723958024649185, 32.72068020363753]],
    "fars": [[52.774306333327075, 27.783613113278296], [54.80041636965403, 29.350049897906384]],
    "gilan": [[49.51970297964443, 36.723356134570075], [50.074512530126086, 37.350391192014015]],
    "golestan": [[54.03575666735229, 36.74310041532487], [56.0847067894281, 37.97433235000328]],
    "hamedan": [[48.496977510833226, 34.771949863056335], [48.54607266288699, 34.829742701427946]],
    "hormozgan": [[53.85825912234896, 26.918796732103132], [56.79160862687573, 28.0590465152307]],
    "ilam": [[46.38534034830629, 33.631416752871694], [46.44516433603614, 33.645922752943754]],
    "kerman": [[56.96634540705045, 30.24100457282701], [57.16444262897366, 30.28518826174309]],
    "kermanshah": [[47.02583789331127, 34.285354498304685], [47.17037676753947, 34.36814465438352]],
    "khorasan jonubi": [[56.88407565011756, 32.14686083374171], [60.454632163118305, 33.43977145932132]],
    "khorasan razavi": [[57.97755104972236, 34.56066570522861], [60.767536859006746, 36.41845351160692]],
    "khorasan shomali": [[56.47399694854693, 37.01631748077273], [58.132932436125735, 37.68442023304664]],
    "khuzestan": [[48.60383423589428, 30.193753439227205], [50.161363964310084, 31.877672206787434]],
    "kohgeluyeh va boyer-ahmad": [[50.593496174666996, 30.026465988732962], [51.24443609280637, 31.165974026780198]],
    "kurdestan": [[46.68246833675071, 35.044876729820764], [47.83053958477711, 36.219054086443265]],
    "lorestan": [[47.98526488850742, 32.99632334782393], [48.831212123895284, 33.94026713937054]],
    "markazi": [[49.24291045951876, 33.849617401160174], [50.74803735884524, 35.44026709756275]],
    "mazandaran": [[51.99308591289693, 35.908473865176795], [53.75089835006653, 36.72728438619639]],
    "qazvin": [[49.98959386192912, 36.260487563562286], [50.03611409342062, 36.3195691742584]],
    "qom": [[50.78752971838482, 34.58737712790035], [50.91318584182311, 34.68342062478711]],
    "semnan": [[52.172134201107376, 34.672133605974615], [56.62980220496242, 36.56551661960558]],
    "sistan va baluchestan": [[59.55332860410693, 25.971069418365243], [62.49112823110174, 28.020608395935472]],
    "tehran": [[51.15952357676887, 35.72087295099695], [51.56876428479741, 35.74818417481581]],
    "yazd": [[54.30209394294927, 31.843381642692794], [54.3855213691665, 31.92617316325892]],
    "zanjan": [[48.47349002323, 36.66755109454743], [48.59072903257514, 36.665028909308184]],
  }

  cities = {
    "mobarake": [51.4978815704373, 32.3479832839657],
    "eslamshahr": [51.2257798513497, 35.5425434649868],
    "nesa": [56.3766898317073, 28.0801197662221],
    "pirbakran": [51.5599806389201, 32.4709782160775],
    "ab bar": [48.9520913335422, 36.9299000989437],
    "abadan": [48.2761373579153, 30.3672619763695],
    "abadeh": [52.6469402325955, 31.1622913473479],
    "abdanan": [47.4192032810159, 32.9904823929652],
    "abgarm": [49.2838156526092, 35.7556134640509],
    "abyek": [50.5440188701165, 36.0408011494338],
    "azarshahr": [45.9721011244775, 37.7739697819889],
    "aradan": [52.4920435102111, 35.2471641142893],
    "aran and bidgol": [51.4778385545633, 34.0610087080385],
    "arian shahr": [59.2355336335619, 33.3315953618065],
    "azadshahr": [55.1737461295326, 37.0874812507948],
    "astara": [48.8700633949955, 38.4225102585869],
    "astane ye ashrafiyeh": [49.9445827966626, 37.2640027092258],
    "ashtian": [50.0011318392062, 34.5281220693723],
    "ashkhaneh": [56.9222014558852, 37.5632951757455],
    "aghajari": [49.8291493942752, 30.6990624601645],
    "aqqala": [54.4501866259129, 37.0167823858566],
    "aleshtar": [48.2617965304293, 33.8633403283973],
    "amol": [52.3453500132401, 36.4714177872153],
    "avaj": [49.2233399864025, 35.5793787191945],
    "abarkuh": [53.2744206026123, 31.1277763382576],
    "abhar": [49.2223643241536, 36.1467353199539],
    "abumusa": [55.0292105678881, 25.8811945827284],
    "ahram": [51.2807647108259, 28.8828912413436],
    "arak": [49.7023706980516, 34.0873461070001],
    "ardabil": [48.12, 38.65],
    "ardestan": [52.3695858444984, 33.3797622220547],
    "ardekan": [54.0090896101587, 32.308603346917],
    "ardal": [50.6617387846516, 31.9984584700655],
    "arzuiyeh": [56.3633028642893, 28.4580135232023],
    "arsanjan": [53.2977677510269, 29.9197465045886],
    "urmia": [45.0802929498993, 37.550100574469],
    "orumiyeh": [45.0802929498993, 37.550100574469],
    "azna": [49.4579084020143, 33.4528446680717],
    "estahban": [54.0380313482802, 29.1271129255799],
    "asadabad": [48.1205521534966, 34.7830809742614],
    "asadiyeh": [60.0233222679032, 32.9154149245174],
    "esfarayen": [57.5072428201457, 37.0766427315883],
    "osku": [46.119414667261, 37.9155114173354],
    "eslamabad": [73.0429169218354, 33.6879935605219],
    "eslamabad-e gharb": [46.5286980280632, 34.1136585916802],
    "eslam abade gharb": [46.5286980280632, 34.1136585916802],
    "islamshahr": [51.2314446765867, 35.5517616918248],
    "eslam-shahr": [51.2314446765867, 35.5517616918248],
    "eshtehard": [50.3680436829226, 35.721510251876],
    "oshtorjan": [51.4797198776317, 32.4754918546087],
    "eshkanan": [53.6085970290508, 27.2247710237328],
    "ashkezar": [54.2068649255399, 32.0003034691212],
    "oshnaviyeh": [45.1000081761921, 37.0395022642376],
    "esfahan": [52.67, 32.57],
    "aslan duz": [47.4138728853462, 39.4423514927527],
    "eghbalieh": [49.9211413665227, 36.2302995373757],
    "eqlid": [52.688839399288, 30.893168234916],
    "alborz": [50.87, 36.02],
    "aligudarz": [49.6910278066028, 33.4028353411171],
    "amlash": [50.1929926181552, 37.0948277662348],
    "omidiyeh": [49.7004920008201, 30.7569167073903],
    "amirkabir": [50.1076880742406, 34.2317822845968],
    "anar": [55.2648733395608, 30.873052517208],
    "anar‚Äè": [55.2648733395608, 30.873052517208],
    "andisheh": [51.0230720134271, 35.7075575585957],
    "andishe": [51.0230720134271, 35.7075575585957],
    "andika": [49.4415506008274, 32.206994208265],
    "andimeshk": [48.3509919287165, 32.4618096981649],
    "ahar": [47.059898717338, 38.4740803542252],
    "ahvaz": [48.6656098946463, 31.3172348686295],
    "evaz": [54.0064956625452, 27.7600479470914],
    "ijrud": [48.2783169920227, 36.431901111994],
    "izeh": [49.8709775533535, 31.8237113271114],
    "iranshahr": [60.6869778460584, 27.2036923001906],
    "izadshahr": [52.127905475027, 36.5943288128387],
    "ilam": [46.92, 32.99],
    "eyvan": [46.3028772111046, 33.8279017495313],
    "ivan": [46.3028772111046, 33.8279017495313],
    "eyvanekey": [52.0703099933453, 35.3418236569532],
    "babaheydar": [50.4676788015151, 32.3299351861072],
    "babol": [52.6768180235978, 36.5386856084386],
    "babolsar": [52.6502699942716, 36.7005246631285],
    "bajestan": [58.1790436855526, 34.5127447226796],
    "bakharz": [60.3101349408239, 34.9980805295035],
    "baruq": [46.3241782360181, 36.953802798765],
    "bazargan": [44.3887655938626, 39.3911684895207],
    "basht": [51.1560932686167, 30.3615499003856],
    "baghebahadoran": [51.1894229022024, 32.3803899595603],
    "baghestan": [51.1323418476747, 35.6471739231502],
    "baghmalek": [49.8899031380279, 31.5264193819411],
    "baft": [56.6012764276578, 29.2331427671871],
    "bafq": [55.4062943070792, 31.6049127099077],
    "baghershahr": [51.4048815128075, 35.5348484432134],
    "baneh": [45.8849846667953, 35.9969493101905],
    "bavi": [48.8874913476122, 31.5861728730708],
    "bojnurd": [57.3233333839811, 37.4745240355424],
    "bojnourd": [57.3233333839811, 37.4745240355424],
    "badreh": [47.0384272900974, 33.306279720465],
    "badrud": [52.0081940868699, 33.6910918716052],
    "borazjan": [51.2169620038855, 29.2707752305423],
    "borkhar": [51.7295199544633, 32.8283840079681],
    "bardkhun": [51.4751981778905, 28.0641323264807],
    "bardaskan": [57.9660257996564, 35.2545876432375],
    "bardsir": [56.5767169202262, 29.9276293271018],
    "borujerd": [48.7665463037901, 33.8945027944148],
    "borujen": [51.2931723020667, 31.9683153737798],
    "bostanabad": [46.8312300950286, 37.843181546988],
    "bastak": [54.3670566272153, 27.1965857125847],
    "bashagard": [57.8996442988613, 26.4554274610629],
    "boshruyeh": [57.4287878846015, 33.868725988317],
    "boldaji": [51.0551769536, 31.9359320716905],
    "bam": [58.3560142831815, 29.0970160435229],
    "bampur": [60.4548372940955, 27.1948623789346],
    "ben": [50.7458942235774, 32.5382034213366],
    "bonab": [46.0544108337985, 37.3386023979983],
    "bandar imam khomeini": [49.0720579885526, 30.4449440533204],
    "bandar-e-torkaman": [54.0707190380815, 36.8937556912869],
    "bandar-e-gaz": [53.9459936473964, 36.7748636414848],
    "bandar-e-lengeh": [54.8930488755878, 26.5673335836437],
    "bandar-e-anzali": [49.4830627518269, 37.4628368308134],
    "bandar-e-abbas": [56.2904778506369, 27.1985935016647],
    "bandar-e-Abbas": [56.2904778506369, 27.1985935016647],
    "bahabad": [56.0191036526463, 31.8768395516591],
    "bahar": [34.89071, 48.44088],
    "baharestan": [32.48651, 51.77891],
    "behbahan": [30.59626, 50.24161],
    "bahraman": [30.90432, 55.72739],
    "behshahr": [36.69554, 53.53464],
    "bahmai": [50.7846265466062, 30.7520386491873],
    "buin zahra": [35.75715, 50.06197],
    "buin and miandasht": [50.1633993823095, 33.0811268375762],
    "bavanat": [53.5935187635007, 30.4857920247266],
    "bushehr": [51.39, 28.51],
    "bukan": [46.2097324789975, 36.5189545456502],
    "bumehen": [35.72785, 51.86883],
    "boyer-ahmad": [50.7560790519524, 30.9268241890758],
    "beyarjomand": [36.07867, 55.80743],
    "bijar": [47.6035783199091, 35.8727832895102],
    "birjand": [32.85693, 59.21955],
    "bisotoun": [47.4449328251199, 34.3953299156842],
    "beyza": [52.4012694594002, 29.9717107507655],
    "bilehsavar": [39.37608, 48.34271],
    "binalud": [59.3401130482819, 35.995737358144],
    "parsabad": [39.64579, 47.90995],
    "parsian": [53.0352289309639, 27.2082077545935],
    "pasargad": [52.4802086417768, 29.5971274654371],
    "pakdasht": [35.47431, 51.6757],
    "paveh": [35.02669, 46.36697],
    "pardis": [35.74235, 51.82141],
    "parand": [50.9588872520853, 35.4725970529321],
    "pol-e dokhtar": [33.15293, 47.71432],
    "poldasht": [39.34785, 45.06837],
    "piranshahr": [45.1434808334276, 36.6932880608966],
    "pishva": [51.7317869050457, 35.3076607975851],
    "tazehabad": [34.73862, 46.15162],
    "tazeh kand-e angut": [39.04097, 47.74365],
    "takestan": [49.6959639585576, 36.067496059287],
    "talesh": [48.9040982339422, 37.7973199696321],
    "taybad": [60.779737927992, 34.7424870117342],
    "tabriz": [38.07929, 46.28915],
    "torbat-e-jam": [35.24165, 60.62162],
    "torbat-e-heydarieh": [35.27846, 59.21302],
    "taft": [31.74266, 54.20771],
    "taftan": [60.7578312465231, 28.5373381003483],
    "tafresh": [34.68502, 50.02263],
    "takab": [47.1064686155059, 36.4000662953561],
    "lesser tunb": [55.1455944605318, 26.2435585336349],
    "tonekabon": [50.8715160673466, 36.8157297486063],
    "tangestan": [50.8345941834226, 28.984512112173],
    "tehran": [51.79, 35.55],
    "tuyserkan": [48.4439148047761, 34.5526250324457],
    "tiran and karvan": [51.1407471481492, 32.710721036338],
    "salas-e babajani": [46.155767569498, 34.7356988758813],
    "jajrom": [56.3732855244633, 36.9515930012708],
    "jajrood": [51.7883810049229, 35.6459961773253],
    "jask": [57.7919290029082, 25.6549345814984],
    "siri": [54.5272656309779, 25.9155271647655],
    "jafarie": [50.51661, 34.77464],
    "joghatai": [57.07721, 36.63965],
    "jolfa": [45.63887, 38.93476],
    "jam": [52.34095, 27.82435],
    "jahrom": [53.56689, 28.49492],
    "javanrud": [46.49219, 34.80616],
    "jowayin": [57.4141268586496, 36.709521647017],
    "junghan": [50.6866, 32.14296],
    "juybar": [52.89983, 36.64101],
    "juyom": [53.97995, 28.26155],
    "jiroft": [57.74197, 28.68039],
    "chaboksar": [50.55472, 36.97464],
    "chabahar": [60.6477, 25.29452],
    "chadegan": [50.62686, 32.77156],
    "chardavol": [46.893245444572, 33.7237968547637],
    "charuymaq": [47.0913364891311, 37.13719591268],
    "chaldoran": [44.3852057001165, 39.0645357221563],
    "chalus": [51.42447, 36.65399],
    "chaypareh": [45.0269728379728, 38.8923943476572],
    "charam": [50.74684, 30.75547],
    "choghadak": [51.02502, 28.98757],
    "chegeni": [46.7770729853743, 33.5562787400106],
    "chenaran": [59.12084, 36.64228],
    "chahar borj": [45.97556, 37.12577],
    "chaharbagh": [50.84798, 35.83815],
    "chavar": [46.29715, 33.69191],
    "hajiabad": [59.99754, 33.60468],
    "hajjiabad": [54.42031, 28.3575],
    "haji abad": [55.90162, 28.30921],
    "hasan abad": [52.62354, 32.13663],
    "hesarak": [50.922872496119, 35.8526061147368],
    "hafshajan": [50.79463, 32.22559],
    "hamidiyeh": [48.4324, 31.48162],
    "khatam": [54.3740375910059, 30.0496857522757],
    "khark": [50.31931, 29.23805],
    "khash": [61.20286, 28.20944],
    "khaf": [60.14429, 34.56287],
    "khanbebin": [54.98782, 37.01268],
    "khanmirza": [51.109506420454, 31.5234963114677],
    "khavarshahr": [51.5618810515963, 35.5544982063653],
    "khoda afarin": [46.9608276274249, 39.1378380375648],
    "khodabandeh": [52.4005901064527, 29.9579834703866],
    "kharameh": [53.31003, 29.49305],
    "khorramabad": [48.34891, 33.45696],
    "khorrambid": [53.1742995511645, 30.5937150585198],
    "khorramdarreh": [49.19539, 36.21146],
    "khorramdasht": [49.51175, 35.92984],
    "khorramshahr": [48.17879, 30.44482],
    "khusf": [58.8877532206736, 32.7786724573309],
    "khoshkebijar": [49.760322551818, 37.3748981056068],
    "khezri": [58.80654, 34.02295],
    "khafr": [53.2058197305681, 28.9672650621921],
    "khalkhal": [48.52737, 37.62075],
    "khalilabad": [58.28516, 35.24499],
    "khomam": [49.65184, 37.38215],
    "khamir": [55.5879, 26.95121],
    "khomein": [50.08031, 33.64108],
    "khomeini shahr": [51.5336, 32.68333],
    "khondab": [49.18894, 34.38345],
    "khansar": [50.31887, 33.21423],
    "khur and biabanak": [54.7848493498906, 33.8562257629289],
    "khormoj": [51.38252, 28.62718],
    "kharzugh": [51.64984, 32.77672],
    "khoshab": [58.1160891905294, 36.7458514473184],
    "khonj": [53.42962, 27.89233],
    "khoy": [44.95465, 38.52029],
    "darab": [54.54712, 28.75426],
    "daran": [50.40914, 32.98622],
    "darrud": [59.11237, 36.13574],
    "dalahu": [46.2434663991475, 34.282713254558],
    "dalgan": [59.5700924523278, 27.5504326895348],
    "damghan": [54.34484, 36.1652],
    "dana": [49.7436, 35.81163],
    "davarzan": [56.87804, 36.35126],
    "dayyer": [51.9380329390063, 27.8410128448805],
    "darb-e behesht": [57.33667, 29.23355],
    "dargaz": [59.10571, 37.44475],
    "darmian": [60.1730246108738, 32.9659806845207],
    "darreh shahr": [47.38166, 33.14949],
    "dezful": [48.4193, 32.37889],
    "dastgerdbarkhar": [51.66571, 32.80205],
    "dasht-e-azadegan": [48.0773959257216, 31.5829403762768],
    "dashtestan": [51.2220833932544, 29.274718471939],
    "dashti": [50.999305698262, 29.2637898590811],
    "delfan": [48.3573261103153, 33.5034640046487],
    "delijan": [50.68166, 33.99036],
    "damavand": [52.04722, 35.69395],
    "dandi": [47.62024, 36.55109],
    "dehdez": [50.2888426122136, 31.7096908833891],
    "dehaqan": [51.65418, 31.93313],
    "dehdasht": [50.56335, 30.79521],
    "dehgolan": [47.4189, 35.27834],
    "dehloran": [47.27085, 32.6902],
    "dorche": [51.5540984044457, 32.6115755006901],
    "dorud": [59.11237, 36.13574],
    "dogonbadan": [50.78301, 30.36346],
    "dolatabad": [59.52212, 35.28208],
    "deylam": [50.1646777547665, 30.0549393082465],
    "divandarreh": [47.02491, 35.91249],
    "rabor": [56.91296, 29.28991],
    "raz and jargalan": [57.1100640791683, 37.9335744465492],
    "rusk": [61.40544, 26.23325],
    "rask": [61.40544, 26.23325],
    "ramsar": [50.66233, 36.91599],
    "ramsheh": [52.5046491821441, 31.8277438824707],
    "ramshir": [49.40883, 30.89276],
    "ramhormoz": [49.60531, 31.25922],
    "ramian": [55.14208, 37.01845],
    "ravar": [56.79842, 31.24226],
    "robat karim": [51.07991, 35.4832],
    "rajai shahr": [50.9738348850754, 35.8589221011238],
    "razan": [49.03511, 35.39065],
    "rostam": [49.49157, 36.88407],
    "rasht": [49.59041, 37.28415],
    "roshtkhar": [59.62305, 34.97507],
    "rezvanshahr": [49.1397, 37.55056],
    "rafsanjan": [55.98765, 30.37528],
    "ravansar": [46.65607, 34.71618],
    "rudan": [57.3787134571066, 27.3861064840402],
    "rudbar": [49.41898, 36.80666],
    "rudbar-e-jonub": [57.9897696595718, 28.0268842083807],
    "rudsar": [50.30025, 37.13265],
    "rudehen": [51.91042, 35.73761],
    "romeshgan": [47.5716054202443, 33.269470136025],
    "royan": [51.96886, 36.57037],
    "rey": [51.43871, 35.60319],
    "rigan": [51.8206541091561, 30.373392961427],
    "zabol": [61.49381, 31.00887],
    "zarch": [54.24261, 31.98427],
    "zahedan": [60.85205, 29.48214],
    "zaveh": [59.46772814773, 35.2747908490352],
    "zeberkhan": [59.0123614572037, 36.1319297219582],
    "zarghan": [52.72178, 29.77383],
    "zarand": [56.55187, 30.81173],
    "zarandieh": [50.535610761517, 35.3328560723556],
    "zarinshahr": [51.38589, 32.39413],
    "zarrineh": [46.9191844495155, 36.061847975427],
    "zanjan": [48.31, 36.58],
    "zavareh": [52.48666, 33.44786],
    "zirab": [52.97469, 36.17964],
    "zirkuh": [59.9948432510687, 33.6029000660379],
    "sari": [53.06002, 36.56688],
    "savojbolagh": [50.6655394291899, 36.0535800208259],
    "saveh": [50.36492, 35.02533],
    "sain qaleh": [49.0721162178282, 36.3029839870287],
    "sabzevar": [57.68232, 36.20921],
    "sepahan shahr": [51.6786603222027, 32.5518332389377],
    "sepid dasht": [48.88391, 33.21978],
    "sepidan": [51.9885040661931, 30.2576080105305],
    "sarab": [47.5288764483666, 37.9423410686856],
    "sarableh": [47.017153506843, 34.5438974725425],
    "sarable": [47.017153506843, 34.5438974725425],
    "sarasiab": [50.9769792328084, 35.6914071733844],
    "saravan": [62.33307, 27.36134],
    "sarayan": [58.52232, 33.86037],
    "sarbaz": [61.25806, 26.63324],
    "sarbandar": [49.0514235930449, 30.5544131424137],
    "sarbisheh": [59.79835, 32.57636],
    "sarpol-e-zahab": [45.86303, 34.44868],
    "sarchehan": [53.6976876100766, 30.0500919692839],
    "sarakhs": [61.1486, 36.54866],
    "sorkheh": [53.21036, 35.46373],
    "sardasht": [50.21788, 30.32781],
    "sareyn": [48.07623, 38.13767],
    "sarvabad": [46.36699, 35.3118],
    "sarvestan": [53.22387, 29.26303],
    "saqqez": [46.27292, 36.24412],
    "selseleh": [48.107324830024, 33.833659075703],
    "soltaniyeh": [48.79551, 36.43363],
    "salmas": [44.76603, 38.19874],
    "salman shahr": [51.19995, 36.69902],
    "semnan": [54.58, 35.89],
    "semirom": [51.57187, 31.41455],
    "sangar": [49.69772, 37.17914],
    "sanandaj": [47.00641, 35.24031],
    "sahand": [46.5002143819581, 37.7302173547922],
    "savadkuh": [52.9816927860521, 36.1081570134961],
    "surak": [53.21167, 36.59392],
    "sureshjan": [50.67885, 32.31581],
    "susangerd": [48.18959, 31.55861],
    "sonqor": [47.5976664067682, 34.7785507793044],
    "siahkal": [49.87237, 37.15109],
    "sib and suran": [61.9709552092698, 27.4261117163186],
    "sirjan": [55.67491, 29.43762],
    "sirik": [57.10929, 26.52111],
    "shadegan": [48.66354, 30.64126],
    "shazand": [49.41088, 33.9337],
    "shandiz": [59.29819, 36.39521],
    "shahrud": [54.97246, 36.41209],
    "shahindezh": [46.56646, 36.67921],
    "shahin shahr": [51.55468, 32.86432],
    "showt": [44.7687619667821, 39.2176894471553],
    "shabestar": [45.70139, 38.1805],
    "sheshtomad": [57.767095466681, 35.9600171493854],
    "shaft": [49.40309, 37.16381],
    "shemshak": [51.4901733407022, 36.011842096876],
    "shemiranat": [51.5730952101133, 35.9398595793913],
    "shahr jadid-e ramin": [48.8890665625086, 31.5925664219302],
    "shahr jadid-e alavi": [51.0729120252698, 34.0513974515952],
    "shahr-e-babak": [55.12079, 30.11833],
    "shahr sanaati alborz": [50.0857259691607, 36.185684724022],
    "shahreza": [51.84943, 31.97666],
    "shahrekord": [50.8582, 32.31618],
    "shahriar": [51.0597, 35.63301],
    "shahmirzad": [53.33358, 35.77023],
    "shorabad": [51.3547223968971, 35.465168230284],
    "shush": [48.25743, 32.20675],
    "shushtar": [48.83472, 32.05464],
    "shuyesheh": [46.67846, 35.35291],
    "shiraz": [52.52912, 29.55689],
    "shirvan": [57.92417, 37.40152],
    "shirin shahr": [48.4433986768599, 31.0845072523118],
    "saleh abad": [48.34307, 34.92209],
    "sabashahr": [51.11427, 35.57876],
    "sahneh": [47.68522, 34.47552],
    "sadra": [52.4933567910651, 29.8078769851865],
    "safadasht": [50.84069, 35.69135],
    "safashahr": [53.19872, 30.61367],
    "safi abad": [48.42151, 32.24784],
    "sowmeeh sara": [49.32012, 37.30283],
    "zahak": [47.1649342500911, 37.3901918281237],
    "zehak": [47.1649342500911, 37.3901918281237],
    "tarom": [47.6554284042246, 34.1021041427505],
    "taleghan": [50.76849, 36.173],
    "tabas": [56.93533, 33.57519],
    "torqabeh": [59.37633, 36.3043],
    "alishahr": [51.0684616712764, 28.9324764206961],
    "abbasabad": [51.11597, 36.72123],
    "ajabshir": [45.89483, 37.4771],
    "asaluyeh": [52.60811, 27.47576],
    "eshqabad": [56.92832, 34.36636],
    "aliabad": [54.8577, 36.9124],
    "anbarabad": [57.84253, 28.47892],
    "farsan": [50.56568, 32.2573],
    "faruj": [58.21891, 37.22369],
    "faryab": [57.22828, 28.09708],
    "famenin": [48.9727071387562, 35.1140007250247],
    "farashband": [52.09375, 28.85889],
    "farahan": [49.688054708577, 34.1141765032353],
    "farrokhshahr": [50.97295, 32.27398],
    "ferdows": [58.17239, 34.01808],
    "fardis": [50.9556461057076, 35.7393928802468],
    "fereydan": [50.4015130344877, 33.0560336441625],
    "fereydunkenar": [52.51669, 36.6828],
    "fereydunshahr": [50.13939, 32.93999],
    "fariman": [59.84828, 35.70403],
    "fasa": [53.63769, 28.91973],
    "fasham": [51.51984, 35.90173],
    "fazelabad": [54.75127, 36.89947],
    "falavarjan": [51.50629, 32.55627],
    "fanuj": [59.64499, 26.57573],
    "fahraj": [58.88511, 28.94784],
    "fulad shahr": [51.40737, 32.48953],
    "fouman": [49.311, 37.2257],
    "firuzabad": [48.10311, 33.89903],
    "firuzkuh": [52.77387, 35.75456],
    "firuzkooh": [52.77387, 35.75456],
    "firuzeh": [58.58902, 36.28561],
    "feyz abad": [58.77512, 35.01462],
    "qaemshahr": [52.86508, 36.46435],
    "qasem abad": [59.86197, 34.3556],
    "qaen": [59.1809, 33.72945],
    "qods": [51.11289, 35.71248],
    "qarchak": [51.58667, 35.41579],
    "gharqabad": [49.8293771056996, 35.1090937644621],
    "gharah aghaj": [46.97224, 37.1291],
    "qarah buteh": [47.9458696979595, 36.3538452554167],
    "qarah zia od din": [45.02517, 38.88854],
    "qorveh": [47.81004, 35.1636],
    "qazvin": [50.00197, 36.28175],
    "qeshm": [56.27288, 26.94894],
    "qasr-e-shirin": [45.58929, 34.50753],
    "qasr-e-qand": [60.74168, 26.21304],
    "qhale ganj": [57.88297, 27.51635],
    "qom": [51.07, 34.71],
    "ghahdarijan": [51.45585, 32.57384],
    "quchan": [58.51087, 37.10237],
    "ghiamdasht": [51.6490826113164, 35.5256228955952],
    "qeydar": [48.58999, 36.10857],
    "qir and karzin": [53.0439, 28.47462],
    "karzin": [53.10852, 28.40872],
    "karun": [48.8719618572313, 31.4797818986248],
    "kazerun": [51.6518, 29.60375],
    "kashan": [51.43208, 33.98339],
    "kashmar": [58.45988, 35.24276],
    "kamyaran": [46.93946, 34.79717],
    "kangan": [52.0614107281289, 27.8459180674704],
    "kabudarahang": [48.72487, 35.20924],
    "karaj": [50.95277, 35.72472],
    "kordkuy": [54.10992, 36.79453],
    "kerman": [57.06418, 30.2814],
    "kermanshah": [47.09714, 34.31409],
    "kerend-e gharb": [46.23204, 34.27871],
    "kerendgharb": [46.23204, 34.27871],
    "kalat": [59.74988, 36.99456],
    "kelardasht": [51.14495, 36.49369],
    "kelak": [52.4262255762537, 35.6177167542561],
    "kalaleh": [55.49162, 37.38112],
    "kelarabad": [51.2486318295854, 36.6856593426702],
    "kaleybar": [47.04078, 38.86485],
    "kelishad": [51.5359, 32.54154],
    "komijan": [49.32233, 34.71912],
    "konarak": [60.39698, 25.35952],
    "kangavar": [47.96202, 34.50167],
    "kahrizak": [51.3551, 35.52382],
    "kohgiluyeh": [50.8326534355997, 30.9164671515052],
    "kahnuj": [57.69707, 27.92245],
    "kavar": [52.68672, 29.19608],
    "kowsar": [48.2793010841863, 38.2000587328001],
    "kojur": [51.7271075580141, 36.3846449623637],
    "koshkoueieh": [55.642605690969, 30.5280366284354],
    "kuhbanan": [56.27934, 31.4132],
    "kuhpayeh": [52.43252, 32.71511],
    "kuhdasht": [47.60846, 33.53415],
    "kuhrang": [50.1457657094974, 32.4521593690206],
    "kuhsorkh": [58.4781383606303, 35.4873845483505],
    "kia kola": [52.81482, 36.58187],
    "kiar": [50.8162845353088, 32.0472613405521],
    "kish": [53.97385, 26.53342],
    "garizat": [54.0737025425165, 31.299748682083],
    "galikash": [55.43107, 37.2704],
    "gotvand": [48.81783, 32.24722],
    "gachsaran": [50.7937438330449, 30.3653104573249],
    "gerash": [54.14503, 27.66714],
    "gorgan": [54.4288, 36.8452],
    "garmdareh": [51.06886, 35.74454],
    "garmsar": [52.33363, 35.21782],
    "garmeh": [56.30154, 36.97852],
    "garmi": [48.0836, 39.01219],
    "germi": [48.0836, 39.01219],
    "golbahar": [59.1922913453383, 36.5724202576977],
    "golpayegan": [50.28336, 33.45095],
    "golshahr": [50.46561, 33.50588],
    "galleh dar": [52.66021, 27.64881],
    "galugah": [53.81105, 36.72514],
    "gomishan": [54.07542, 37.07166],
    "gonabad": [58.68571, 34.35175],
    "ganaveh": [50.5130949716565, 29.5814027236174],
    "gonbad-e-kavus": [55.17574, 37.24781],
    "gahru": [50.88629, 32.00153],
    "gorveh darjazin": [49.0993775717242, 35.3130026192525],
    "gohardasht": [58.451396841304, 34.3005353651524],
    "gilan-e-gharb": [45.92477, 34.14032],
    "lar": [54.32036, 27.64265],
    "larestan": [54.3152508062048, 27.6580203402462],
    "lashar": [60.6811225148195, 27.2046019334747],
    "lalejin": [48.4784, 34.97359],
    "lali": [49.09298, 32.32982],
    "lamerd": [53.18792, 27.32997],
    "langerud": [50.14743, 37.19567],
    "lahijan": [50.01082, 37.20239],
    "lenjan": [51.3295135277841, 32.470025514272],
    "landeh": [50.41969, 30.98267],
    "langrud": [50.14743, 37.19567],
    "lavasan": [51.63729, 35.8194],
    "lordegan": [50.83009, 31.51082],
    "lowshan": [49.51477, 36.63126],
    "lumar": [46.81136, 33.56718],
    "margon": [51.07814, 30.99334],
    "masal": [49.13177, 37.3655],
    "maku": [44.49244, 39.29215],
    "maneh and samalqan": [56.519653931705, 37.8277914004976],
    "mahdasht": [50.80613, 35.72756],
    "mahshahr": [49.1809302248229, 30.5523974471811],
    "mahneshan": [47.67065, 36.74358],
    "mobarakeh": [51.50068, 32.34177],
    "majlesi": [51.4974781998735, 32.1977068040146],
    "mahallat": [50.45414, 33.90838],
    "mohammad shahr": [50.89955, 35.73664],
    "mohammadiyeh": [50.18259, 36.22402],
    "mahmudabad": [46.51901, 36.71188],
    "maragheh": [46.2336, 37.38604],
    "maraveh tapeh": [55.96173, 37.90471],
    "marand": [45.77205, 38.43194],
    "marvdasht": [52.81027, 29.85951],
    "maruset": [54.21077, 30.46539],
    "marivan": [46.18097, 35.51787],
    "mes-e sarcheshmeh": [55.7939365754324, 29.9990687977272],
    "masjed soleyman": [49.28634, 31.96466],
    "meshkindasht": [50.94078, 35.74839],
    "meshginshahr": [47.67258, 38.39719],
    "mashhad": [59.57567, 36.31043],
    "molla bodagh": [48.7372482872651, 35.631350277154],
    "mollasani": [48.88701, 31.58535],
    "malard": [50.97918, 35.6547],
    "malayer": [48.81655, 34.29732],
    "malekan": [46.10038, 37.14253],
    "malekshahi": [46.5820740325265, 33.3948848599392],
    "mamasani": [51.5379129468711, 30.1148548256741],
    "manjil": [49.41854, 36.7413],
    "manujan": [57.49676, 27.40367],
    "mahabad": [45.72841, 36.77022],
    "mehdishahr": [53.34587, 35.69965],
    "mohr": [52.88385, 27.55046],
    "mehran": [46.17289, 33.12203],
    "mehraban": [47.13167, 38.08159],
    "mehrestan": [61.6713652297876, 27.1260495555402],
    "mehriz": [54.43782, 31.55742],
    "mahvelat": [58.7848403999636, 35.015344726506],
    "meyami": [55.65165, 36.40932],
    "miandoab": [46.10595, 36.96496],
    "miandorud": [48.42446, 32.22787],
    "mianeh": [47.71635, 37.42071],
    "meybod": [54.01814, 32.24225],
    "mirjaveh": [61.44955, 29.01564],
    "meymeh": [51.17035, 33.44674],
    "minab": [57.07415, 27.09759],
    "minudasht": [55.37509, 37.22966],
    "minudasht alamut": [55.37509, 37.22966],
    "naeen": [53.09562, 32.86045],
    "narmashir": [58.6941075414775, 28.9509360087434],
    "nain": [53.09562, 32.86045],
    "najafabad": [51.35059, 32.63153],
    "nasim shahr": [51.16949, 35.55869],
    "nasrabad": [52.06197, 32.27835],
    "natanz": [51.91907, 33.50468],
    "nazarabad": [50.60453, 35.95195],
    "neghab": [57.40816, 36.70855],
    "naqadeh": [45.3889, 36.95338],
    "neka": [53.29365, 36.65187],
    "negel": [46.5221428902529, 35.289487569784],
    "namakabrud": [51.3061865882816, 36.671923381175],
    "namin": [48.37551, 34.16821],
    "nahavand": [48.37551, 34.16821],
    "nehbandan": [60.03781, 31.54079],
    "nur": [52.01588, 36.57307],
    "nurabad": [47.97319, 34.0704],
    "nourabad": [51.52225, 30.11482],
    "noor abad": [47.97319, 34.0704],
    "noorabad": [47.97319, 34.0704],
    "noshahr": [51.49984, 36.64708],
    "neyriz": [54.32265, 29.19792],
    "nir": [54.12882, 31.48486],
    "neyshabur": [58.79403, 36.20793],
    "nikabad": [52.20521, 32.30278],
    "nikshahr": [60.22686, 26.23455],
    "nimvar": [50.5736107213018, 33.8872708926315],
    "nimrus": [60.5440271642405, 30.9598081677385],
    "hadishahr": [45.6636606799597, 38.8403730594079],
    "hamun": [61.3283521971222, 30.9394498067446],
    "harat": [54.3697, 30.05082],
    "harsin": [47.58038, 34.27],
    "herand": [52.43729, 32.56386],
    "heris": [47.11712, 38.24962],
    "hashtrud": [47.05967, 37.47078],
    "hashtgerd": [50.68386, 35.95068],
    "haftkel": [49.53314, 31.44568],
    "hamedan": [48.64, 34.91],
    "hendijan": [49.7114, 30.22369],
    "hanguye": [54.008596057295, 27.0681521246483],
    "hurand": [47.36513, 38.85719],
    "holeylan": [47.0989060026542, 33.7768337257094],
    "hoveyzeh": [48.07749, 31.46068],
    "hichrod": [51.3428392022973, 36.6823644168481],
    "hidaj": [49.12959, 36.25404],
    "hirmand": [63.4983098974944, 30.5882999596098],
    "vavan": [51.2231543262418, 35.5063227770933],
    "varamin": [51.63469, 35.3294],
    "varzaqan": [46.65034, 38.50871],
    "varzaneh": [52.65061, 32.42032],
    "yasuj": [51.58242, 30.65676],
    "yazd": [54.86, 31.48]
  }
}
